---
name: Stale PR Detection

'on':
  schedule:
    # Run every Monday at 9:00 AM UTC
    - cron: '0 9 * * 1'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - name: Mark stale PRs
        uses: actions/stale@v9
        with:
          # General settings
          days-before-stale: 30
          days-before-close: 60

          # PR-specific settings
          stale-pr-message: |
            This pull request has been automatically marked as stale
            because it has not had any activity for 30 days.

            **What happens next:**
            - If no activity occurs within 60 additional days,
              this PR will be closed (90 days total inactivity)
            - To keep this PR open, add a comment or push new commits
            - If this PR is blocked or waiting for something,
              please add a comment explaining the situation

            **If this PR should be closed:**
            - If the work has been completed elsewhere,
              please close it with a reference
            - If this PR is no longer needed,
              please close it with an explanation

          close-pr-message: |
            This pull request has been automatically closed due to
            inactivity (90 days with no updates).

            If you believe this PR should be reopened, please:
            1. Comment on this PR explaining why it should be reopened
            2. A maintainer can reopen it if appropriate

          stale-pr-label: 'stale'
          close-pr-label: 'auto-closed'

          # Labels to exempt from being marked stale
          exempt-pr-labels: 'pinned,security,blocked,in-review'

          # Don't mark draft PRs as stale (they're already WIP)
          exempt-draft-pr: true

          # Only process PRs (not issues)
          only-pr-labels: ''

          # Operational settings
          operations-per-run: 30
          remove-stale-when-updated: true

          # Don't process issues, only PRs
          days-before-issue-stale: -1
          days-before-issue-close: -1
